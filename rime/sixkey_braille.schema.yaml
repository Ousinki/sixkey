# Rime schema
# encoding: utf-8
#
# SixKey 盲文打字 (Braille to Text)
# 使用 SDF-JKL 并击输入盲文，输出中文
#
# 键位：S=3点 D=2点 F=1点 J=4点 K=5点 L=6点
# 并击 = 同时按下多个键再同时松开
#
# 每个并击产生一个拼音片段（声母或韵母），
# 连续两次并击组成完整拼音音节，进入候选。

schema:
  schema_id: sixkey_braille
  name: "SixKey"
  version: "2.0"
  author:
    - SixKey Project
  description: |
    使用 SDF-JKL 六键并击输入盲文。
    S=3点 D=2点 F=1点 J=4点 K=5点 L=6点
    并击产生拼音，通过拼音输入中文。
    技巧：所有键必须同时按下再同时松开！
  dependencies:
    - luna_pinyin

switches:
  - name: ascii_mode
    reset: 0
    states: [中文, 西文]
  - name: simplification
    reset: 1
    states: [漢字, 汉字]

engine:
  processors:
    - ascii_composer
    - recognizer
    - chord_composer
    - key_binder
    - speller
    - punctuator
    - selector
    - navigator
    - express_editor
  segmentors:
    - ascii_segmentor
    - matcher
    - abc_segmentor
    - punct_segmentor
    - fallback_segmentor
  translators:
    - punct_translator
    - script_translator
  filters:
    - simplifier
    - uniquifier

chord_composer:
  # 并击按键表，按此顺序排列并击编码
  # 击键虽有先后，形成并击时一律按此顺序排列
  alphabet: "sdfjkl"
  # 将并击编码（排序后的按键组合）转换为拼音的规则
  # 键位：S=dot3 D=dot2 F=dot1 J=dot4 K=dot5 L=dot6
  # 基于现行盲文标准 (GB/T 15720)，与 braille.js 一致
  algebra:
    # ====================================
    # 6键 (1 种)
    # ====================================
    - "xform/^sdfjkl$/ua/" # dots 123456 = ua(⠿)

    # ====================================
    # 5键 (6 种)
    # ====================================
    - "xform/^sdfjk$/ch/" # dots 12345 = ch(⠟)
    - "xform/^sdfjl$/yuan/" # dots 12346 = üan/van(⠯)
    - "xform/^sdfkl$/ou/" # dots 12356 = ou(⠷)
    - "xform/^sfjkl$/uai/" # dots 13456 = uai(⠽)
    - "xform/^dfjkl$/uan/" # dots 12456 = uan(⠻)
    - "xform/^sdjkl$/yue/" # dots 23456 = üe/ve(⠾)

    # ====================================
    # 4键 (15 种)
    # ====================================
    - "xform/^sdfj$/p/" # dots 1234 = p(⠏)
    - "xform/^sdfk$/er/" # dots 1235 = er(⠗)
    - "xform/^sdfl$/an/" # dots 1236 = an(⠧)
    - "xform/^sfjk$/n/" # dots 1345 = n(⠝)
    - "xform/^sfjl$/iang/" # dots 1346 = iang(⠭)
    - "xform/^sfkl$/z/" # dots 1356 = z(⠵)
    - "xform/^dfjk$/g/" # dots 1245 = g/j(⠛) 靠韵母区分
    - "xform/^dfjl$/ia/" # dots 1246 = ia(⠫)
    - "xform/^dfkl$/iou/" # dots 1256 = iou(⠳)
    - "xform/^sdjk$/t/" # dots 2345 = t(⠞)
    - "xform/^sdjl$/ei/" # dots 2346 = ei(⠮)
    - "xform/^sdkl$/uang/" # dots 2356 = uang(⠶)
    - "xform/^sjkl$/eng/" # dots 3456 = eng(⠼)
    - "xform/^djkl$/uei/" # dots 2456 = uei/ui(⠺)
    - "xform/^fjkl$/iong/" # dots 1456 = iong(⠹)

    # ====================================
    # 3键 (20 种)
    # ====================================
    - "xform/^sdf$/l/" # dots 123 = l(⠇)
    - "xform/^sfj$/m/" # dots 134 = m(⠍)
    - "xform/^sfk$/uo/" # dots 135 = uo(⠕)
    - "xform/^sfl$/u/" # dots 136 = u(⠥)
    - "xform/^dfj$/f/" # dots 124 = f(⠋)
    - "xform/^dfk$/h/" # dots 125 = h/x(⠓) 靠韵母区分
    - "xform/^dfl$/in/" # dots 126 = in(⠣)
    - "xform/^fjk$/d/" # dots 145 = d(⠙)
    - "xform/^fjl$/ian/" # dots 146 = ian(⠩)
    - "xform/^fkl$/sh/" # dots 156 = sh(⠱)
    - "xform/^sdj$/s/" # dots 234 = s(⠎)
    - "xform/^sdk$/ao/" # dots 235 = ao(⠖)
    - "xform/^sdl$/ang/" # dots 236 = ang(⠦)
    - "xform/^sjk$/iao/" # dots 345 = iao(⠜)
    - "xform/^sjl$/v/" # dots 346 = ü/v(⠬)
    - "xform/^skl$/en/" # dots 356 = en(⠴)
    - "xform/^djk$/r/" # dots 245 = r(⠚)
    - "xform/^djl$/ai/" # dots 246 = ai(⠪)
    - "xform/^dkl$/ong/" # dots 256 = ong(⠲)
    - "xform/^jkl$/yun/" # dots 456 = ün/vn(⠸)

    # ====================================
    # 2键 (15 种)
    # ====================================
    - "xform/^df$/b/" # dots 12 = b(⠃)
    - "xform/^sf$/k/" # dots 13 = k/q(⠅) 靠韵母区分
    - "xform/^fj$/c/" # dots 14 = c(⠉)
    - "xform/^fk$/ie/" # dots 15 = ie(⠑)
    - "xform/^fl$/ing/" # dots 16 = ing(⠡)
    - "xform/^dj$/i/" # dots 24 = i(⠊)
    - "xform/^dk$/un/" # dots 25 = un/uen(⠒)
    - "xform/^dl$/e/" # dots 26 = o/e(⠢) 默认输出 e
    - "xform/^sj$/zh/" # dots 34 = zh(⠌)
    - "xform/^sk$/a/" # dots 35 = a(⠔)
    - "xform/^sl$/yet/" # dots 36 = (未使用)
    - "xform/^jk$/yet/" # dots 45 = (未使用)
    - "xform/^jl$/yet/" # dots 46 = (未使用)
    - "xform/^kl$/yet/" # dots 56 = (未使用)

    # 单键 = 无效
    - "xform/^s$//"
    - "xform/^d$//"
    - "xform/^f$//"
    - "xform/^j$//"
    - "xform/^k$//"
    - "xform/^l$//"

  # 并击完成后套用的格式（不加隔音符，让声母韵母自然拼接）
  output_format: {}
  # 并击过程中显示的提示（显示点位符号）
  prompt_format:
    - "xlit|sdfjkl|③②①④⑤⑥|"

editor:
  bindings:
    BackSpace: back_syllable

speller:
  alphabet: "zyxwvutsrqponmlkjihgfedcba"
  delimiter: " "
  # o/e 在盲文中共用 dots 26，并击默认输出 e
  # 以下规则允许 b/p/m/f + e 匹配词典中的 b/p/m/f + o
  algebra:
    - derive/^([bpmf])o$/$1e/

translator:
  dictionary: luna_pinyin
  prism: sixkey_braille
  preedit_format: {}

punctuator:
  import_preset: default

key_binder:
  import_preset: default
  bindings:
    - { when: paging, accept: comma, send: comma }
    - { when: has_menu, accept: period, send: period }

recognizer:
  import_preset: default
